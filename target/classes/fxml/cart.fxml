<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.shape.SVGPath?>

<VBox spacing="0"
      styleClass="root"
      xmlns="http://javafx.com/javafx"
      xmlns:fx="http://javafx.com/fxml"
      fx:controller="com.cmpe343.fx.controller.CartController">
      
    <!-- TOP BAR (Same as Customer Page) -->
    <HBox alignment="CENTER_LEFT" spacing="18" styleClass="topbar">
        <VBox spacing="2">
            <Label text="Group7 GreenGrocer" styleClass="brand"/>
            <Label fx:id="welcomeLabel" text="Welcome back" styleClass="muted"/>
        </VBox>

        <Region HBox.hgrow="ALWAYS"/>

        <!-- Search -->
        <HBox alignment="CENTER_LEFT" styleClass="searchbar">
            <SVGPath content="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                     styleClass="icon-muted"/>
            <TextField fx:id="searchField" promptText="Search vegetables &amp; fruits..."
                       styleClass="searchField"/>
            <Button text="Clear" onAction="#handleClearSearch" styleClass="btn-ghost"/>
        </HBox>

        <Region prefWidth="8"/>

        <!-- User -->
        <HBox alignment="CENTER" spacing="12" styleClass="userbox">
            <StackPane styleClass="avatar">
                <Label fx:id="avatarLetter" text="U" styleClass="avatar-text"/>
            </StackPane>

            <VBox spacing="0">
                <Label fx:id="usernameLabel" text="User" styleClass="user-name"/>
                <Label fx:id="resultInfoLabel" text="Shopping Cart" styleClass="muted tiny"/>
            </VBox>

            <Region prefWidth="6"/>

            <!-- Cart -->
            <StackPane onMouseClicked="#handleBack" styleClass="icon-btn-wrap">
                <Button styleClass="icon-btn" mouseTransparent="true">
                    <graphic>
                        <SVGPath content="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.54-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"
                                 styleClass="icon-white"/>
                    </graphic>
                </Button>

                <Label fx:id="cartCountBadge" text="0" visible="false"
                       styleClass="badge" mouseTransparent="true"
                       StackPane.alignment="TOP_RIGHT">
                    <StackPane.margin><Insets top="-6" right="-6"/></StackPane.margin>
                </Label>
            </StackPane>

            <Button text="Log Out" onAction="#handleLogout" styleClass="btn-outline-small"/>
        </HBox>
    </HBox>

    <!-- BODY -->
    <VBox spacing="24" style="-fx-padding: 32;">

    <HBox spacing="24" VBox.vgrow="ALWAYS">
        <!-- Cart Items Column -->
        <VBox spacing="16" HBox.hgrow="ALWAYS">
            <ScrollPane fitToWidth="true" styleClass="scroll-pane" VBox.vgrow="ALWAYS" style="-fx-padding: 0;">
                <VBox fx:id="cartItemsContainer" styleClass="list-container" spacing="12"/>
            </ScrollPane>
        </VBox>

        <!-- Summary Column -->
        <VBox spacing="24" minWidth="350" prefWidth="350" styleClass="summary-column">
            <VBox spacing="20" styleClass="card" style="-fx-padding: 24;">
                <Label text="Order Summary" styleClass="h2"/>
                
                <Separator style="-fx-opacity: 0.1;"/>
                
                <Label text="Delivery Details" styleClass="h3"/>
                
                <VBox spacing="16">
                     <VBox spacing="4">
                        <Label text="Date" styleClass="field-label"/>
                        <DatePicker fx:id="deliveryDatePicker" promptText="Select Date" style="-fx-base: #1e293b;" maxWidth="Infinity"/>
                     </VBox>
                     
                     <VBox spacing="4">
                        <Label text="Time (HH:mm)" styleClass="field-label"/>
                        <TextField fx:id="deliveryTimeField" promptText="e.g. 14:30" styleClass="field"/>
                     </VBox>
                     
                     <HBox spacing="8" alignment="CENTER_LEFT" style="-fx-padding: 8; -fx-background-color: rgba(59, 130, 246, 0.1); -fx-background-radius: 8;">
                        <SVGPath content="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" 
                                 fill="#3b82f6"/>
                        <Label text="Delivery must be within 48 hours" styleClass="sub" style="-fx-text-fill: #60a5fa;" wrapText="true"/>
                     </HBox>
                </VBox>
                
                <Separator style="-fx-opacity: 0.1;"/>

                <VBox spacing="16">
                    <HBox spacing="16" alignment="CENTER_LEFT">
                        <Label text="Total" styleClass="h2"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="totalLabel" text="0.00 â‚º" styleClass="h2" style="-fx-text-fill: #10b981; -fx-font-size: 24px; -fx-font-weight: 800;"/>
                    </HBox>
                    <Button fx:id="placeOrderButton" text="Place Order" onAction="#handlePlaceOrder" styleClass="btn-primary" maxWidth="Infinity" style="-fx-padding: 14; -fx-font-size: 16px; -fx-font-weight: 700;"/>
                </VBox>
            </VBox>
        </VBox>
    </HBox>
    </VBox>

</VBox>
